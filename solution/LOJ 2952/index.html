<!doctype HTML>
<html lang="zh-CN" style="position: fixed; width: 100%; overflow: hidden; ">

<head>
  <meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<meta name="viewport" content="width=1200">

<title>「NOIP2018」赛道修建 - 题解 - Tsuki's blog</title>

<link rel="icon" href="/static/img/favicon.ico" type="image/x-icon" />

<link href="https://cdn.jsdelivr.net/npm/syzoj-public-cdn@1.0.1/cdnjs/semantic-ui/2.4.1/semantic.min.css" rel="stylesheet">

<link href="/static/css/style.css" rel="stylesheet">

<link href="https://cdn.jsdelivr.net/npm/syzoj-public-cdn@1.0.1/google-fonts/fira-mono.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/syzoj-public-cdn@1.0.1/google-fonts/lato.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/syzoj-public-cdn@1.0.1/google-fonts/open-sans.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/syzoj-public-cdn@1.0.1/google-fonts/exo-2.css" rel="stylesheet">

<script src="https://cdn.jsdelivr.net/npm/syzoj-public-cdn@1.0.1/cdnjs/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/syzoj-public-cdn@1.0.1/cdnjs/semantic-ui/2.4.1/semantic.min.js"></script>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y"
  crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx"
  crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe"
  crossorigin="anonymous"></script>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    renderMathInElement(document.body, {
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false },
      ]
    });
  });
</script>

<link href="/static/css/hljs.css" rel="stylesheet">
<link href="/static/css/custom.css" rel="stylesheet">
<script src="/static/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<style type="text/css">
  /* Chart.js */
  @-webkit-keyframes chartjs-render-animation {
    from {
      opacity: 0.99
    }

    to {
      opacity: 1
    }
  }

  @keyframes chartjs-render-animation {
    from {
      opacity: 0.99
    }

    to {
      opacity: 1
    }
  }

  .chartjs-render-monitor {
    -webkit-animation: chartjs-render-animation 0.001s;
    animation: chartjs-render-animation 0.001s;
  }
</style>
</head>

<body style="position: relative; margin-top: 49px; height: calc(100% - 49px); overflow-y: overlay;">
  <div class="ui fixed borderless menu" style="position: fixed; height: 49px; ">
  <div class="ui container">
    <a class="header item" href="/"><span style="font-family: Raleway; font-size: 1.5em; ">Tsuki's blog</span></a>
    <a class="item" href="/"><i class="home icon"></i>首页</a>
    <a class="item active" href="/solutions"><i class="list icon"></i>题解</a>
    <a class="item" href="/articles"><i class="pencil icon"></i>文章</a>
    <a class="item" href="/about"><i class="help circle icon"></i>关于</a>
    <div class="right menu item">
      <div class="ui toggle checkbox" id="dark_theme">
        <link rel="stylesheet" href="" type="text/css" id="dark_theme_style">
        <link rel="stylesheet" href="" type="text/css" id="dark_hljs_style">
        <script>
          if (localStorage.getItem('dark_theme') === '1') {
            document.write('<input type="checkbox" checked>');
            document.getElementById('dark_theme_style').href = '/static/css/dark-theme.css';
            document.getElementById('dark_hljs_style').href = '/static/css/dark-hljs.css';
          } else {
            document.write('<input type="checkbox">');
          }
        </script>
        <script>
          $(function () {
            $('#dark_theme').checkbox('setting', 'onChange', function () {
              let checked = $('#dark_theme').checkbox('is checked');
              localStorage.setItem('dark_theme', checked ? '1' : '0');
              if (checked) {
                document.getElementById('dark_theme_style').href = '/static/css/dark-theme.css';              
                document.getElementById('dark_hljs_style').href = '/static/css/dark-hljs.css';
              } else {
                document.getElementById('dark_theme_style').href = '';
                document.getElementById('dark_hljs_style').href = '';
              }
            });
          });
        </script>
        <label>更换暗色主题</label>
      </div>
    </div>
  </div>
</div>

  <div style="margin-top: 28px; ">
    <div class="ui main container">
      
  <div class="ui center aligned grid">
    
    <div class="row">
      <h1 class="ui header">LOJ #2952. 「NOIP2018」赛道修建</h1>
    </div>

    
    <div class="row" style="margin-top: -15px">
          <span class="ui label">内存限制：512 MiB</span>
          <span class="ui label">时间限制：1000 ms</span>
          <span class="ui label">输入文件：track.in</span>
            <span class="ui label">输出文件：track.out</span>
        </div>

      <div class="row" style="margin-top: -23px">
          <span class="ui label">题目类型：传统</span>
        
          <span class="ui label">评测方式：文本比较</span>
        
      </div>

    <div class="row" style="margin-top: -23px">
      
        <span class="ui label">上传者：未知</span>
      
    </div>
  </div>

  
  <div class="ui grid">
    <div class="row">
      <div class="column">
        <div class="ui buttons">
          <a class="small ui primary button" href="https://loj.ac/problem/2952">原题链接</a>
          <a class="small ui positive button" href="https://raw.githubusercontent.com/cutekibry/cutekibry.github.io-Source/master/content/solutions/LOJ 2952 「NOIP2018」赛道修建.md">查看源代码</a>
          <a class="small ui orange button" href="https://github.com/cutekibry/cutekibry.github.io-Source/commits/master/content/solutions/LOJ 2952 「NOIP2018」赛道修建.md">修改历史</a>
          <a class="small ui yellow button" href="https://github.com/cutekibry/cutekibry.github.io-Source/blame/master/content/solutions/LOJ 2952 「NOIP2018」赛道修建.md">版本对比</a>
          ::after
        </div>
      </div>
    </div>

    

    
      <div class="row">
          <div class="column">
            <h4 class="ui top attached block header">题目描述</h4>
            <div class="ui bottom attached segment font-content">
              <div style="position: relative; overflow: hidden;">
                <p>C 城将要举办一系列的赛车比赛。在比赛前，需要在城内修建 <latex>$m$</latex> 条赛道。</p>
<p>C 城一共有 <latex>$n$</latex> 个路口，这些路口编号为 <latex>$1,2, \cdots , n$</latex>，有 <latex>$n − 1$</latex> 条适合于修建赛道的双向通行的道路，每条道路连接着两个路口。其中，第 <latex>$i$</latex> 条道路连接的两个路口编号为 <latex>$a_i$</latex> 和 <latex>$b_i$</latex>，该道路的长度为 <latex>$l_i$</latex>。借助这 <latex>$n − 1$</latex> 条道路，从任何一个路口出发都能到达其他所有的路口。</p>
<p>一条赛道是一组互不相同的道路 <latex>$e_1, e_2, \cdots , e_k$</latex>，满足可以从某个路口出发，依次经过道路 <latex>$e_1, e_2, \cdots , e_k$</latex>（每条道路经过一次，不允许调头）到达另一个路口。一条赛道的长度等于经过的各道路的长度之和。为保证安全，要求每条道路至多被一条赛道经过。</p>
<p>目前赛道修建的方案尚未确定。你的任务是设计一种赛道修建的方案，使得修建的 <latex>$m$</latex> 条赛道中长度最小的赛道长度最大（即 <latex>$m$</latex> 条赛道中最短赛道的长度尽可能大）。</p>

              </div>
            </div>
          </div>
        </div>
    
    
      <div class="row">
          <div class="column">
            <h4 class="ui top attached block header">输入格式</h4>
            <div class="ui bottom attached segment font-content">
              <div style="position: relative; overflow: hidden;">
                <p>输入文件名为 <code>track.in</code>。</p>
<p>输入文件第一行包含两个由空格分隔的正整数 <latex>$n,m$</latex>，分别表示路口数及需要修建的赛道数。</p>
<p>接下来 <latex>$n − 1$</latex> 行，第 <latex>$i$</latex> 行包含三个正整数 <latex>$a_i,b_i,l_i$</latex>，表示第 <latex>$i$</latex> 条适合于修建赛道的道路连接的两个路口编号及道路长度。保证任意两个路口均可通过这 <latex>$n − 1$</latex> 条道路相互到达。每行中相邻两数之间均由一个空格分隔。</p>

              </div>
            </div>
          </div>
        </div>
    
    
      <div class="row">
          <div class="column">
            <h4 class="ui top attached block header">输出格式</h4>
            <div class="ui bottom attached segment font-content">
              <div style="position: relative; overflow: hidden;">
                <p>输出文件名为 <code>track.out</code>。</p>
<p>输出共一行，包含一个整数，表示长度最小的赛道长度的最大值。</p>

              </div>
            </div>
          </div>
        </div>
    
    
      <div class="row">
          <div class="column">
            <h4 class="ui top attached block header">样例</h4>
            <div class="ui bottom attached segment font-content">
              <div style="position: relative; overflow: hidden;">
                <h4>样例输入 1</h4>
<div class="ui existing segment"><pre><code class="lang-plain">7 1
1 2 10
1 3 5
2 4 9
2 5 8
3 6 6
3 7 7
</code></pre></div>
<h4>样例输出 1</h4>
<div class="ui existing segment"><pre><code class="lang-plain">31
</code></pre></div>
<h4>样例解释 1</h4>
<p>所有路口及适合于修建赛道的道路如下图所示：</p>
<p><img src="https://i.loli.net/2018/11/25/5bfa35d26f803.png" alt="track1.png" style="display: block; margin: 0px auto;"></p>
<p>道路旁括号内的数字表示道路的编号，非括号内的数字表示道路长度。</p>
<p>需要修建 <latex>$1$</latex> 条赛道。可以修建经过第 <latex>$3,1,2,6$</latex> 条道路的赛道（从路口 <latex>$4$</latex> 到路口 <latex>$7$</latex>），则该赛道的长度为 <latex>$9 + 10 + 5 + 7 = 31$</latex>，为所有方案中的最大值。</p>
<h4>样例输入 2</h4>
<div class="ui existing segment"><pre><code class="lang-plain">9 3
1 2 6
2 3 3
3 4 5
4 5 10
6 2 4
7 2 9
8 4 7
9 4 4
</code></pre></div>
<h4>样例输出 2</h4>
<div class="ui existing segment"><pre><code class="lang-plain">15
</code></pre></div>
<h4>样例解释 2</h4>
<p>所有路口及适合于修建赛道的道路如下图所示：</p>
<p><img src="https://i.loli.net/2018/11/25/5bfa35d282f80.png" alt="track2.png" style="display: block; margin: 0px auto;"></p>
<p>需要修建 <latex>$3$</latex> 条赛道。可以修建如下 <latex>$3$</latex> 条赛道：</p>
<ol>
<li>经过第 <latex>$1,6$</latex> 条道路的赛道（从路口 <latex>$1$</latex> 到路口 <latex>$7$</latex>），长度为 <latex>$6 + 9 = 15$</latex>；</li>
<li>经过第 <latex>$5,2,3,8$</latex> 条道路的赛道（从路口 <latex>$6$</latex> 到路口 <latex>$9$</latex>），长度为 <latex>$4 + 3 + 5 + 4 = 16$</latex>；</li>
<li>经过第 <latex>$7,4$</latex> 条道路的赛道（从路口 <latex>$8$</latex> 到路口 <latex>$5$</latex>），长度为 <latex>$7 + 10 = 17$</latex>。</li>
</ol>
<p>长度最小的赛道长度为 <latex>$15$</latex>，为所有方案中的最大值。</p>

              </div>
            </div>
          </div>
        </div>
    
    
      <div class="row">
          <div class="column">
            <h4 class="ui top attached block header">数据范围与提示</h4>
            <div class="ui bottom attached segment font-content">
              <div style="position: relative; overflow: hidden;">
                <p>所有测试数据的范围和特点如下表所示：</p>
<table class="ui celled table">
<thead><tr>
<th style="text-align:center">测试点编号</th>
<th style="text-align:center"><latex>$n$</latex></th>
<th style="text-align:center"><latex>$m$</latex></th>
<th style="text-align:center"><latex>$a_i=1$</latex></th>
<th style="text-align:center"><latex>$b_i=a_i+1$</latex></th>
<th style="text-align:center">分支不超过 <latex>$3$</latex></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><latex>$1$</latex></td>
<td style="text-align:center"><latex>$\le 5$</latex></td>
<td style="text-align:center"><latex>$=1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$2$</latex></td>
<td style="text-align:center"><latex>$\le 10$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$3$</latex></td>
<td style="text-align:center"><latex>$\le 15$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center"><latex>$4$</latex></td>
<td style="text-align:center"><latex>$\le 10^3$</latex></td>
<td style="text-align:center"><latex>$=1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$5$</latex></td>
<td style="text-align:center"><latex>$\le 3\times 10^4$</latex></td>
<td style="text-align:center"><latex>$=1$</latex></td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center"><latex>$6$</latex></td>
<td style="text-align:center"><latex>$\le 3\times 10^4$</latex></td>
<td style="text-align:center"><latex>$=1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center"><latex>$7$</latex></td>
<td style="text-align:center"><latex>$\le 3\times 10^4$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center"><latex>$8$</latex></td>
<td style="text-align:center"><latex>$\le 5\times 10^4$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">是</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center"><latex>$9$</latex></td>
<td style="text-align:center"><latex>$\le 10^3$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$10$</latex></td>
<td style="text-align:center"><latex>$\le 3\times 10^4$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$11$</latex></td>
<td style="text-align:center"><latex>$\le 5\times 10^4$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$12$</latex></td>
<td style="text-align:center"><latex>$\le 50$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$13$</latex></td>
<td style="text-align:center"><latex>$\le 50$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$14$</latex></td>
<td style="text-align:center"><latex>$\le 200$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$15$</latex></td>
<td style="text-align:center"><latex>$\le 200$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$16$</latex></td>
<td style="text-align:center"><latex>$\le 10^3$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">是</td>
</tr>
<tr>
<td style="text-align:center"><latex>$17$</latex></td>
<td style="text-align:center"><latex>$\le 10^3$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center"><latex>$18$</latex></td>
<td style="text-align:center"><latex>$\le 3\times 10^4$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center"><latex>$19$</latex></td>
<td style="text-align:center"><latex>$\le 3\times 10^4$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
<tr>
<td style="text-align:center"><latex>$20$</latex></td>
<td style="text-align:center"><latex>$\le 5\times 10^4$</latex></td>
<td style="text-align:center"><latex>$\le n-1$</latex></td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
<td style="text-align:center">否</td>
</tr>
</tbody>
</table>
<p>其中，「分支不超过 <latex>$3$</latex>」的含义为：每个路口至多有 <latex>$3$</latex> 条道路与其相连。</p>
<p>对于所有的数据，<latex>$2 \le n \le 5\times 10^4, \ 1 \le m \le n − 1,\ 1 \le a_i,b_i \le n,\  1 \le l_i \le 10^4$</latex>。</p>

              </div>
            </div>
          </div>
        </div>
    
    
      <div class="row">
          <div class="column">
            <h4 class="ui top attached block header">题解</h4>
            <div class="ui bottom attached segment font-content">
              <div style="position: relative; overflow: hidden;">
                <p>显然可以二分最小的路径长度 <latex>$minlen$</latex>，然后计算是否能在树上找出不少于 <latex>$m$</latex> 条长度不小于 <latex>$minlen$</latex> 的路径。</p>
<p>先考虑朴素 DP。设 <latex>$f[i][j]$</latex> 表示在 <latex>$i$</latex> 的子树中，保留 <latex>$i \rightarrow p$</latex>（<latex>$p$</latex> 为子树内某一节点）且 <latex>$i \rightarrow p$</latex> 的链长度为 <latex>$j$</latex>，所能得获得的最多路径数。</p>
<p>时间复杂度为 <latex>$O(n^2l_i)$</latex>。</p>
<p>然而并没有必要如此。我们可以贪心：令 <latex>$f[i]$</latex> 表示在 <latex>$i$</latex> 的子树中，局部答案的最大值；<latex>$g[i]$</latex> 表示局部答案最大的情况下，能保留的最长链长度。</p>
<p>考虑怎么证明其正确性。如果我们要增加一条经过 <latex>$i$</latex> 点的路径，那么根据贪心算法，必定会有两个路径要取消掉（这样才能增加 <latex>$son \rightarrow p$</latex> 链的长度）。显然，这是不划算的。</p>
<p>用 <code>std::multiset</code> 二分即可。实现细节留作读者练习。</p>
<p>时间复杂度：<latex>$O(n \log^2 n)$</latex>。</p>

              </div>
            </div>
          </div>
        </div>
    
    
      <div class="row">
          <div class="column">
            <h4 class="ui top attached block header">代码</h4>
            <div class="ui bottom attached segment font-content">
              <div style="position: relative; overflow: hidden;">
                <div class="ui existing segment"><pre><code class="lang-cpp">#include &lt;algorithm&gt;
#include &lt;cstdio&gt;
#include &lt;set&gt;

typedef std::multiset&lt;int&gt; Mset;

#ifdef ONLINE_JUDGE
const int MAXN = 100000 + 10;
#else
const int MAXN = 1000 + 10;
#endif

int n, m;
int minlen;
int pre[MAXN &lt;&lt; 1], to[MAXN &lt;&lt; 1], wdis[MAXN &lt;&lt; 1], head[MAXN], wcnt;
int f[MAXN], g[MAXN], fa[MAXN];

inline void addedge(int u, int v, int w) {
    wcnt++;
    pre[wcnt] = head[u];
    head[u] = wcnt;
    to[wcnt] = v;
    wdis[wcnt] = w;
}
inline void add2edge(int u, int v, int w) {
    addedge(u, v, w);
    addedge(v, u, w);
}

#define v to[i]
#define w wdis[i]
void predfs(int u) {
    int i;

    for (i = head[u]; i; i = pre[i]) {
        if (fa[u] ^ v) {
            fa[v] = u;
            predfs(v);
        }
    }
}

void dfs(int u) {
    static Mset s;
    int i;
    static Mset::iterator xit, yit, rit;

    f[u] = g[u] = 0;

    for (i = head[u]; i; i = pre[i])
        if (fa[u] ^ v)
            dfs(v);

    for (i = head[u]; i; i = pre[i]) {
        if (fa[u] ^ v) {
            f[u] += f[v];
            if (g[v] + w &lt; minlen)
                s.insert(g[v] + w);
            else
                f[u]++;
        }
    }

    for (xit = s.begin(); xit != s.end(); xit = rit) {
        yit = s.lower_bound(minlen - (*xit));
        if (xit == yit)
            yit++;

        rit = xit;
        rit++;
        if (yit != s.end()) {
            f[u]++;
            if (rit == yit)
                rit++;
            s.erase(xit);
            s.erase(yit);
        }
    }
    if (!s.empty()) {
        xit = s.end();
        xit--;
        g[u] = (*xit);
        s.clear();
    }
}
#undef v
#undef w

int main() {
#ifndef ONLINE_JUDGE
    freopen(&quot;2952.in&quot;, &quot;r&quot;, stdin);
    freopen(&quot;2952.out&quot;, &quot;w&quot;, stdout);
#else
    freopen(&quot;track.in&quot;, &quot;r&quot;, stdin);
    freopen(&quot;track.out&quot;, &quot;w&quot;, stdout);
#endif

    int i, u, v, w;
    int l, r;

    scanf(&quot;%d %d&quot;, &amp;n, &amp;m);
    for (i = 1; i &lt; n; i++) {
        scanf(&quot;%d %d %d&quot;, &amp;u, &amp;v, &amp;w);
        add2edge(u, v, w);
    }
    predfs(1);

    l = 1;
    r = 1e9;
    while (l ^ r) {
        minlen = (l + r + 1) &gt;&gt; 1;

        dfs(1);
        if (f[1] &gt;= m)
            l = minlen;
        else
            r = minlen - 1;
    }
    printf(&quot;%d\n&quot;, l);
    return 0;
}
</code></pre></div>

              </div>
            </div>
          </div>
        </div>
    
  </div>
  
  <div style="height: 120px"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<div id="vcomments"></div>
<script>
  new Valine({
    el: '#vcomments',
    appId: 'ag8HLEJ5i9Pu4EbbfVEejxYY-gzGzoHsz',
    appKey: 'TjVP6wlGquVVCLQjHql57cs4',
    notify: false,
    verify: false,
    avatar: 'mm',
    placeholder: 'Enter text'
  });
</script>

    </div>
    <div class="ui vertical footer segment" style="margin-top: 15px; ">
  <div class="ui center aligned container">
    <span style="color: #999;">
      Theme Based on <a href="https://loj.ac" target="_blank">LibreOJ</a>. <br />
      Last build: 2019-12-14 23:23:11.
    </span>
  </div>
</div>
  </div>
</body>

</html>